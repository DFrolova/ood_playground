from ....assets.ood_methods.image_statistics import *

from ood.dataset.svd_benchmark.msd import MSD
from ood.dataset.utils import ZoomImage, ScaleUniversal
from ood.paths import MSD_DATASET_DATA_PATH


voxel_spacing = (1., 1., 1.5)
dataset = MSD(MSD_DATASET_DATA_PATH) >> ZoomImage(new_spacing=voxel_spacing) #>> ScaleUniversal()
load_x = dataset.image

train_predictions_path = '.'

ood_tasks = ['Task04_Hippocampus', 'Task07_Pancreas', 'Task09_Spleen']

train_id_ids = [uid for uid in dataset.ids if dataset.task(uid) not in ood_tasks and dataset.fold(uid) == 'imagesTr']
test_id_ids = [uid for uid in dataset.ids if dataset.task(uid) not in ood_tasks and dataset.fold(uid) == 'imagesTs']
ood_ids = [uid for uid in dataset.ids if dataset.task(uid) in ood_tasks]

split = [[train_id_ids,
          [],
          test_id_ids + ood_ids]]
