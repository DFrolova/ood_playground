from ....assets.ood_methods.image_statistics import *

import numpy as np
from sklearn.model_selection import train_test_split
from connectome import Filter, Chain

from amid.mood import MOOD
from ood.dataset.utils import ZoomImage
from ood.paths import MOOD_DATA_PATH


voxel_spacing = (0.7, 0.7875, 0.7)
dataset = Chain(
    MOOD(MOOD_DATA_PATH),
    Filter(lambda task: task == 'brain'),
    ZoomImage(new_spacing=voxel_spacing)
)
load_x = dataset.image

train_predictions_path = '.'

id_ids = [uid for uid in dataset.ids if dataset.fold(uid) == 'train']
toy_ids = [uid for uid in dataset.ids if dataset.fold(uid) == 'toy']

random_state_split = np.random.RandomState(0xBadCafe)
train_id_ids, test_id_ids = train_test_split(id_ids, test_size=0.1, random_state=random_state_split, shuffle=True)

split = [[train_id_ids,
          [],
          test_id_ids + toy_ids]]
