from ....assets.core_lidc import *
from ....assets.utils.no_pred_logits import *
from ....assets.dataset.lidc_setup import *
from ....assets.dataset.lidc import *
from ....assets.batch_iter.patch_sampling_3d_axial_cutpaste import *
from ....assets.architecture.unet_lidc import *
from ....assets.cross_val.lidc import *
from ....assets.metric.metrics_3d import *


max_cache_size = 810
seed = 2

mood_top1_top100mean = lambda true, pred: np.mean(pred.ravel()[np.argsort(pred, axis=None)[-100:]])
mood_top1_mean = lambda true, pred: np.mean(pred)
mood_top1_max = lambda true, pred: np.max(pred)


final_metrics_lidc = {'mood_top1_top100mean': mood_top1_top100mean,
                      'mood_top1_mean': mood_top1_mean,
                      'mood_top1_max': mood_top1_max, }

final_metrics_cc359_midrc = {'mood_top1_top100mean': mood_top1_top100mean,
                             'mood_top1_mean': mood_top1_mean,
                             'mood_top1_max': mood_top1_max, }

device = 'cuda'
