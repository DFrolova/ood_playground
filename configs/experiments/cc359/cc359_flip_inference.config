from ...assets.core import *
# from ...assets.utils.no_pred import *
from ...assets.utils.no_pred_logits import *
from ...assets.dataset.cc359 import *
from ...assets.batch_iter.patch_sampling_3d import *
from ...assets.architecture.unet3d import *
from ...assets.cross_val.cv_cc359 import *
from ...assets.metric.metrics_3d import *

import os

from ood.paths import ENSEMBLE_MODELS_PATH


seed = 4
saved_model_path = os.path.join(ENSEMBLE_MODELS_PATH, f'seed{seed}/experiment_0/model.pth')
ood_ids = []

ax = 1 # axis to flip: 0 - symmetric horizontal, 1 - vertical

load_x = lambda uid: np.flip(dataset.load_image(uid), axis=SPATIAL_DIMS[:2][ax])
load_y = lambda uid: np.flip(dataset.load_segm(uid), axis=SPATIAL_DIMS[:2][ax])