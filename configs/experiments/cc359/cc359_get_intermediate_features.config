from ...assets.core import *
from ...assets.dataset.cc359 import *
from ...assets.batch_iter.patch_sampling_3d import *
from ...assets.architecture.unet3d import *
from ...assets.cross_val.cv_cc359 import *
from ...assets.metric.metrics_3d import *

from ood.utils import skip_predict, skip_calculating_metrics
from ood.torch.module.unet import UNet3DWithActivations


n_experiments = 1
architecture = UNet3DWithActivations(n_chans_in=n_chans_in, n_chans_out=n_chans_out, n_filters_init=n_filters)
saved_model_path = f'/shared/experiments/ood_playground/cc359/ensemble2/seed0/experiment_0/model.pth'

validate_step = None

predict_features_no_extra_dim = lambda x: predict_features(x)[0]
predict_to_dir = partial(commands.predict, ids=test_ids, load_x=load_x, predict_fn=predict_features_no_extra_dim)
predict_logits_to_dir = skip_predict
evaluate_individual_metrics = skip_calculating_metrics