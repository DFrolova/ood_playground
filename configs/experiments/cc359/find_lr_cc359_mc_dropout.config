from ..assets.core_3d import *
from ..assets.utils.no_pred import *
from ..assets.dataset.cc359 import *
from ..assets.batch_iter.patch_sampling_3d import *
from ..assets.architecture.unet3d_lr import *
from ..assets.cross_val.cv_cc359 import *
from ..assets.metric.metrics_3d import *


from dpipe.torch.functional import weighted_cross_entropy_with_logits
from ood.torch.module.unet3d_mc_dropout import UNet3D_MC_Dropout


n_experiments = 1
n_epochs = 60
batches_per_epoch = 1
batch_size = 2

criterion = weighted_cross_entropy_with_logits
x_patch_size = y_patch_size = np.array([128, ] * 3)

p_dropout = 0.1
architecture = UNet3D_MC_Dropout(n_chans_in=n_chans_in, n_chans_out=n_chans_out, 
                                 n_filters_init=n_filters, p_dropout=p_dropout)