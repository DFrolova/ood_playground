from ...assets.core import *
from ...assets.utils.no_pred import *
# from ...assets.utils.no_pred_logits import *
from ...assets.dataset.cc359 import *
from ...assets.batch_iter.patch_sampling_3d import *
from ...assets.architecture.unet3d import *
from ...assets.cross_val.cv_cc359 import *
from ...assets.metric.metrics_3d import *

from ood.metric.metric import evaluate_individual_metrics_with_froc_no_pred_with_crops


seed = 0

ood_ids = []
pred_patch_stride = 10

n_repeats = 5

evaluate_individual_metrics = partial(
    evaluate_individual_metrics_with_froc_no_pred_with_crops,
    load_y=load_y,
    load_x=load_x,
    predict=predict,
    predict_logit=predict_logit,
    metrics=final_metrics,
    test_ids=test_ids,
    x_patch_size=x_patch_size,
    pred_patch_stride=pred_patch_stride,
    random_state=random_state,
    n_repeats=n_repeats,
)