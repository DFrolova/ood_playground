from ...assets.core import *
from ...assets.utils.no_pred import *
# from ...assets.utils.no_pred_logits import *
from ...assets.dataset.cc359 import *
from ...assets.batch_iter.patch_sampling_3d import *
from ...assets.architecture.unet3d import *
from ...assets.cross_val.cv_cc359 import *
from ...assets.metric.metrics_3d import *

from dpipe.im.box import get_centered_box
from dpipe.im.shape_ops import crop_to_box
from ood.metric.ood_metric import get_abs_ue_score, get_entropy
from ood.metric.metric import evaluate_individual_metrics_with_froc_no_pred_with_crops


n_experiments = 1

seed = 0

ood_ids = []

final_metrics = {'dice_score': dice_metric, 'sdice_score': sdice_metric, 'entropy': get_entropy, 
                 'abs_ue_score': get_abs_ue_score}

n_repeats = 5

evaluate_individual_metrics = partial(
    evaluate_individual_metrics_with_froc_no_pred_with_crops,
    load_y=load_y,
    load_x=load_x,
    predict=predict,
    predict_logit=predict_logit,
    metrics=final_metrics,
    test_ids=test_ids,
    x_patch_size=x_patch_size,
    random_state=random_state,
    n_repeats=n_repeats,
)