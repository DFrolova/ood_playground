import numpy as np

from dpipe.dataset.wrappers import apply, cache_methods
from ood.dataset.task4_hippo import Task4Hippo
from ood.dataset.utils import scale_mri, Rescale3D
from ood.paths import TASK4_HIPPO_PATH


data_path = TASK4_HIPPO_PATH

# if `voxel_spacing[i]` is `None` when `i`-th dimension will be used without scaling
# voxel_spacing = (None, None, None)
voxel_spacing = (1, 0.95, 0.95)

preprocessed_dataset = apply(Rescale3D(Task4Hippo(data_path), voxel_spacing), load_image=scale_mri)
dataset = apply(preprocessed_dataset, load_image=np.float32)
