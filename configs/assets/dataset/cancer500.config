from connectome import Chain, Filter
from amid.cancer_500 import MoscowCancer500

from dpipe.io import load
from ood.dataset.cancer500 import CancerMask
from ood.dataset.utils import VoxelSpacing, Zoom
from ood.paths import CANCER500_DATA_PATH
from ood.utils import get_lib_root_path


filtered_ids = load(os.path.join(get_lib_root_path(), 'configs/assets/dataset/cancer500_ids_filtered.json'))

dataset = Chain(
    MoscowCancer500(root=CANCER500_DATA_PATH),
    Filter(lambda id: id in filtered_ids),
    VoxelSpacing(),
    CancerMask(),
    Zoom(new_spacing=voxel_spacing),
    ScaleHU(),
    Shape()
)

load_y = dataset.mask
